#!/bin/bash
# Добавление статических маршрутов на HQ-RTR

# Маршрут по умолчанию через ISP
ip route add default via 172.16.4.1 dev ens18

# Маршрут до сети BR-RTR (192.168.200.0/27) через GRE тунель
ip route add 192.168.200.0/27 via 10.10.10.1 dev gre0

# Если GRE тунель еще не поднят, то нужно его поднять. Предполагаем, что он уже настроен.

# Включение форвардинга
echo 1 > /proc/sys/net/ipv4/ip_forward

# Сохранение маршрутов (для ALT Linux)
# Маршрут по умолчанию
cat > /etc/sysconfig/network-scripts/route-ens18 << 'EOF'
default via 172.16.4.1
EOF

# Маршрут до сети BR-RTR через GRE (если нужен отдельный файл, но для GRE тунеля, возможно, не требуется)
# Для GRE тунеля маршрут можно добавить в общую таблицу, но для сохранения между перезагрузками:
cat > /etc/sysconfig/network-scripts/route-gre0 << 'EOF'
192.168.200.0/27 via 10.10.10.1
EOF

echo "Маршруты на HQ-RTR добавлены"